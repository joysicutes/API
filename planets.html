<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>KameKameHUB - DBZ Planets</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body style="background-color: #f5f0e6;">

    <div class="container-fluid p-3 border-bottom shadow-sm text-white" style=" background-color: #000080">
        <div class="row align-items-center">
            <div class="col-6">
                <a href="index.html" class="text-decoration-none">
                    <h1 class="logo fs-4 my-0 text-start fw-bold text-white">KameKameHUB</h1>
                </a>
            </div>
            <div class="col-6 text-end d-flex justify-content-end align-items-center">
                <img src="assets/images/logo.png" alt="Dragon Ball Z Planet" style="height:40px; width:auto;">
            </div>
        </div>
    </div>

    <div class="container mb-4 mt-5">
        <div class="row">
            <div class="col-12 text-center fw-bold">
                <div class="display-3"
                    style="color:#FF8C00; border-bottom: 3px solid #FF8C00; padding-bottom: 10px; display:inline-block;"
                    id="section-title">All Planets</div>
            </div>
        </div>

        <div class="row mt-4 justify-content-center">

            <div class="col-12 col-md-6 col-lg-4 mb-3">
                <div class="input-group">
                    <input type="text" class="form-control form-control-lg" placeholder="Search by planet name..."
                        id="search-input" onkeyup="updateFilteredList()">
                    <button class="btn btn-warning btn-lg" type="button"
                        onclick="document.getElementById('search-input').value = ''; updateFilteredList();">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-x-lg" viewBox="0 0 16 16">
                            <path
                                d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z" />
                        </svg>
                    </button>
                </div>
            </div>

            <div class="col-12 text-center fw-bold d-flex flex-wrap justify-content-center align-items-center gap-3"
                id="filter-buttons-container">
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row" id="contents">
            <div class="col-12 text-center" id="loading-indicator">
                <div class="spinner-border text-warning" role="status" style="width: 4rem; height: 4rem;">
                    <span class="visually-hidden">kamekameeeeehaa.....</span>
                </div>
                <p style="color:#FF8C00;" class="mt-2">Loading planets...</p>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'https://dragonball-api.com/api/planets?page=1&limit=100';
        let allPlanets = [];
        
        const getPlanetStyles = (isDestroyed) => {
            if (isDestroyed) {
                return {
                    mainColor: '#c62828', 
                    cardBg: '#ffebee', 
                };
            } else {
                return {
                    mainColor: '#000080', 
                    cardBg: 'white', 
                    imageBg: '#c8e6c9' 
                };
            }
        };

        var contents = document.getElementById("contents");
        var loadingIndicator = document.getElementById("loading-indicator");
        var sectionTitle = document.getElementById("section-title");
        var filterContainer = document.getElementById("filter-buttons-container");
        var searchInput = document.getElementById("search-input"); 

        const renderPlanets = (planetsToDisplay) => {
            contents.innerHTML = '';

            if (planetsToDisplay.length === 0) {
                contents.innerHTML = `<div class="col-12 text-center"><p class="h4 mt-5" style="color:#3f0071;">No planets found matching the search term.</p></div>`;
                return;
            }

            planetsToDisplay.forEach(planet => {
                const planetName = planet.name || 'Unknown Planet';
                const isDestroyed = planet.isDestroyed;
                const isDragonBall = planet.isDragonBall;
                const planetImage = planet.image || 'https://via.placeholder.com/200?text=No+Image';

                const styles = getPlanetStyles(isDestroyed); 

                const statusText = isDestroyed ? 'DESTROYED' : 'ACTIVE';
                const dbText = isDragonBall ? 'Dragon Ball Planet' : 'No DB';

                contents.innerHTML += `
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex align-items-stretch"> 
                    <div class="card my-3 shadow p-3 rounded-4 text-center w-100" 
                        style="background-color:${styles.cardBg}; 
                               border:1px solid ${styles.mainColor}; 
                               color:${styles.mainColor};">
                        
                        <div class="mx-auto rounded-3" 
                             style="width: 100%; height: 250px; 
                                    background-color:${styles.imageBg}; 
                                    overflow: hidden; 
                                    display: flex; 
                                    align-items: center; 
                                    justify-content: center; 
                                    padding: 10px;">
                            <img src="${planetImage}" 
                                onerror="this.src='https://via.placeholder.com/200?text=No+Image';" 
                                class="w-100 h-100" style="object-fit: contain;"> 
                        </div>
                        
                        <div class="mt-3">
                            <div class="h5 m-0" style="color:${styles.mainColor}; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                ${planetName}
                            </div>

                            <div class="small mt-1" style="font-weight: 700; color: ${styles.mainColor};">
                                STATUS: ${statusText}
                            </div>
                        
                            <div class="mt-2 rounded-5 py-1 px-3 d-inline-block" 
                                style="background-color:${isDragonBall ? '#FF8C00' : '#455a64'}; color:white; font-weight:bold; font-size:0.9rem;">
                                ${dbText}
                            </div>
                        </div>
                    </div>
                </div>
                `;
            });
        };

        const updateFilteredList = () => {
            const searchTerm = searchInput.value.toLowerCase();
            sectionTitle.textContent = 'All Planets';

            let finalFilteredList = allPlanets.filter(planet => 
                (planet.name || '').toLowerCase().includes(searchTerm)
            );

            finalFilteredList.sort((a, b) => {
                const nameA = (a.name || 'Unknown').toUpperCase();
                const nameB = (b.name || 'Unknown').toUpperCase();
                return nameA < nameB ? -1 : nameA > nameB ? 1 : 0;
            });

            renderPlanets(finalFilteredList);
        };


        const initializePlanets = async () => {
            try {
                const response = await fetch(API_URL);

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const data = await response.json();
                allPlanets = data.items;

                loadingIndicator.style.display = 'none';
                
                searchInput = document.getElementById("search-input"); 

                updateFilteredList();

            } catch (error) {
                console.error("Error fetching Dragon Ball planets:", error);
                loadingIndicator.innerHTML = `<p class="text-danger">Failed to load planets. Error: ${error.message}. Please ensure you are running this page on a local web server (e.g., Live Server).</p>`;
                loadingIndicator.style.display = 'block';
            }
        };

        initializePlanets();
    </script>


    <div class="container-fluid py-3 text-center text-white" style="background-color: #000080;">
        <p class="mb-0">&copy; AllRightsReserved2025</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

</body>

</html>